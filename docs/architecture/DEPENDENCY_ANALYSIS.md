# Context Scraper MCP Server - Python æ–‡ä»¶ä¾å­˜å…³ç³»åˆ†æ

## ğŸ“Š é¡¹ç›®æ¶æ„æ¦‚è§ˆ

æœ¬é¡¹ç›®é‡‡ç”¨**åˆ†å±‚æ¼”è¿›æ¶æ„**ï¼Œä» V1 åˆ° V5 é€æ­¥å¢å¼ºåŠŸèƒ½ï¼Œæ¯ä¸ªç‰ˆæœ¬éƒ½å‘ä¸‹å…¼å®¹ã€‚

## ğŸ—ï¸ æ ¸å¿ƒæ–‡ä»¶ä¾å­˜å…³ç³»å›¾

```
server.py (ä¸»å…¥å£)
â”œâ”€â”€ åŸºäº Crawl4AI + FastMCP
â”œâ”€â”€ ç‹¬ç«‹å®ç°ï¼Œæ— å†…éƒ¨ä¾èµ–
â””â”€â”€ æä¾›åŸºç¡€çˆ¬å–åŠŸèƒ½

server_v3_smart.py (V3æ™ºèƒ½ç‰ˆ)
â”œâ”€â”€ åŸºäº server.py çš„åŠŸèƒ½
â”œâ”€â”€ ä¾èµ–: anti_detection.py
â”œâ”€â”€ ä¾èµ–: smart_prompts.py
â””â”€â”€ å¢åŠ æ™ºèƒ½æç¤ºå’Œåçˆ¬è™«åŠŸèƒ½

server_v4_simple.py (V4ç ”ç©¶ç‰ˆ)
â”œâ”€â”€ å¯¼å…¥: from server_v3_smart import *
â”œâ”€â”€ ä¾èµ–: simple_config.py
â”œâ”€â”€ å¢åŠ æ™ºèƒ½ç ”ç©¶åŠ©æ‰‹åŠŸèƒ½
â””â”€â”€ æ”¯æŒ Claude API é›†æˆ

server_v5.py (V5åˆ†å±‚ç‰ˆ)
â”œâ”€â”€ å¯¼å…¥: from server_v4_simple import *
â”œâ”€â”€ ä¾èµ–: server_v5_core.py
â”œâ”€â”€ å¢åŠ åˆ†å±‚æ‰§è¡Œå¼•æ“
â””â”€â”€ å®æ—¶è¿›åº¦åé¦ˆ

server_v5_core.py (V5æ ¸å¿ƒå¼•æ“)
â”œâ”€â”€ ç‹¬ç«‹æ ¸å¿ƒæ¶æ„
â”œâ”€â”€ æ— å†…éƒ¨ä¾èµ–
â””â”€â”€ æä¾›åˆ†å±‚æ‰§è¡Œå’Œè¿›åº¦è·Ÿè¸ª
```

## ğŸ“ æ–‡ä»¶åˆ†ç±»å’ŒåŠŸèƒ½

### ğŸš€ ä¸»æœåŠ¡å™¨æ–‡ä»¶ (4ä¸ª)

#### 1. `server.py` - åŸºç¡€ç‰ˆæœ¬
- **åŠŸèƒ½**: åŸºç¡€ç½‘é¡µçˆ¬å–å’Œå†…å®¹æå–
- **ä¾èµ–**: ä»…å¤–éƒ¨åº“ (crawl4ai, mcp)
- **çŠ¶æ€**: ç‹¬ç«‹è¿è¡Œï¼Œæ— å†…éƒ¨ä¾èµ–

#### 2. `server_v3_smart.py` - æ™ºèƒ½ç‰ˆæœ¬
- **åŠŸèƒ½**: æ™ºèƒ½æç¤ºè·¯ç”± + åçˆ¬è™«æ£€æµ‹
- **ä¾èµ–**: 
  - `anti_detection.py` (åçˆ¬è™«æ¨¡å—)
  - `smart_prompts.py` (æ™ºèƒ½æç¤ºæ¨¡å—)
- **ç»§æ‰¿**: åŸºäº server.py çš„åŠŸèƒ½æ¦‚å¿µ

#### 3. `server_v4_simple.py` - ç ”ç©¶ç‰ˆæœ¬
- **åŠŸèƒ½**: æ™ºèƒ½ç ”ç©¶åŠ©æ‰‹ + Claude API é›†æˆ
- **ä¾èµ–**:
  - `from server_v3_smart import *` (å®Œå…¨ç»§æ‰¿V3)
  - `simple_config.py` (é…ç½®ç®¡ç†)
- **æ–°å¢**: IntentAnalyzer, SmartResearchAssistant

#### 4. `server_v5.py` - åˆ†å±‚ç‰ˆæœ¬ (æœ€æ–°)
- **åŠŸèƒ½**: åˆ†å±‚æ‰§è¡Œå¼•æ“ + å®æ—¶è¿›åº¦åé¦ˆ
- **ä¾èµ–**:
  - `from server_v4_simple import *` (å®Œå…¨ç»§æ‰¿V4)
  - `server_v5_core.py` (V5æ ¸å¿ƒå¼•æ“)
- **æ–°å¢**: 4ç§ç ”ç©¶æ¨¡å¼ï¼Œå®æ—¶è¿›åº¦è·Ÿè¸ª

### ğŸ§  æ ¸å¿ƒåŠŸèƒ½æ¨¡å— (4ä¸ª)

#### 1. `server_v5_core.py` - V5æ ¸å¿ƒå¼•æ“
- **åŠŸèƒ½**: åˆ†å±‚æ‰§è¡Œæ¶æ„ï¼Œè¿›åº¦è·Ÿè¸ªç³»ç»Ÿ
- **ä¾èµ–**: æ— å†…éƒ¨ä¾èµ–ï¼Œçº¯æ ¸å¿ƒé€»è¾‘
- **æä¾›**: V5LayeredEngine, V5ProgressTracker, ResearchMode

#### 2. `anti_detection.py` - åçˆ¬è™«æ¨¡å—
- **åŠŸèƒ½**: ç”¨æˆ·ä»£ç†ç”Ÿæˆï¼Œåœ°ç†ä½ç½®ä¼ªè£…ï¼Œé‡è¯•ç®¡ç†
- **ä¾èµ–**: ä»…å¤–éƒ¨åº“ (crawl4ai)
- **æä¾›**: EnhancedAntiDetection, GeolocationSpoofer, RetryManager

#### 3. `smart_prompts.py` - æ™ºèƒ½æç¤ºæ¨¡å—
- **åŠŸèƒ½**: ä¸­æ–‡å£è¯­åŒ–éœ€æ±‚ç†è§£ï¼Œæ™ºèƒ½è·¯ç”±
- **ä¾èµ–**: æ— ä¾èµ–ï¼Œçº¯é€»è¾‘å¤„ç†
- **æä¾›**: SmartPromptRouter, analyze_user_request

#### 4. `simple_config.py` - é…ç½®ç®¡ç†
- **åŠŸèƒ½**: Claude API é…ç½®ç®¡ç†
- **ä¾èµ–**: æ— ä¾èµ–ï¼Œæ–‡ä»¶æ“ä½œ
- **æä¾›**: SimpleConfig ç±»

### ğŸ› ï¸ å·¥å…·å’Œç®¡ç†æ–‡ä»¶ (4ä¸ª)

#### 1. `system_manager.py` - ç³»ç»Ÿç®¡ç†
- **åŠŸèƒ½**: é¡¹ç›®çŠ¶æ€ç›‘æ§ï¼Œåƒåœ¾æ–‡ä»¶æ¸…ç†
- **ä¾èµ–**: ä»…ç³»ç»Ÿåº“ (psutil, pathlib)
- **æä¾›**: MCPProjectManager

#### 2. `manage_server.py` - æœåŠ¡å™¨ç®¡ç†
- **åŠŸèƒ½**: æœåŠ¡å™¨å¯åŠ¨/åœæ­¢/é‡å¯
- **ä¾èµ–**: æ— å†…éƒ¨ä¾èµ–
- **æä¾›**: MCPServerManager

#### 3. `quick_test_v5.py` - V5æµ‹è¯•è„šæœ¬
- **åŠŸèƒ½**: V5åŠŸèƒ½å¿«é€ŸéªŒè¯
- **ä¾èµ–**: 
  - `server_v5_core.py` (æµ‹è¯•æ ¸å¿ƒç»„ä»¶)
  - åŠ¨æ€å¯¼å…¥å…¶ä»–æ¨¡å—è¿›è¡Œæµ‹è¯•

#### 4. `server_v2_enhanced.py` - å†å²ç‰ˆæœ¬
- **çŠ¶æ€**: å·²åºŸå¼ƒï¼Œä¿ç•™ä½œä¸ºå‚è€ƒ
- **åŠŸèƒ½**: V2å¢å¼ºåŠŸèƒ½å®ç°

## ğŸ”„ ç‰ˆæœ¬æ¼”è¿›è·¯å¾„

```
V1 (åŸºç¡€) â†’ V2 (å¢å¼º) â†’ V3 (æ™ºèƒ½) â†’ V4 (ç ”ç©¶) â†’ V5 (åˆ†å±‚)
    â†“           â†“           â†“           â†“           â†“
server.py â†’ [åºŸå¼ƒ] â†’ v3_smart â†’ v4_simple â†’ v5.py
                        â†“           â†“           â†“
                anti_detection  simple_config  v5_core
                smart_prompts
```

## ğŸ“Š ä¾èµ–å…³ç³»çŸ©é˜µ

| æ–‡ä»¶ | å†…éƒ¨ä¾èµ– | å¤–éƒ¨ä¾èµ– | è¢«ä¾èµ– |
|------|----------|----------|--------|
| `server.py` | æ—  | crawl4ai, mcp | æ¦‚å¿µè¢«V3ç»§æ‰¿ |
| `anti_detection.py` | æ—  | crawl4ai | V3, V4, V5 |
| `smart_prompts.py` | æ—  | æ—  | V3, V4, V5 |
| `server_v3_smart.py` | anti_detection, smart_prompts | crawl4ai, mcp | V4, V5 |
| `simple_config.py` | æ—  | æ—  | V4, V5 |
| `server_v4_simple.py` | server_v3_smart, simple_config | crawl4ai, mcp, aiohttp | V5 |
| `server_v5_core.py` | æ—  | æ—  | V5 |
| `server_v5.py` | server_v4_simple, server_v5_core | crawl4ai, mcp | æ—  |
| `system_manager.py` | æ—  | psutil, pathlib | å·¥å…·è°ƒç”¨ |
| `manage_server.py` | æ—  | subprocess | ç‹¬ç«‹å·¥å…· |
| `quick_test_v5.py` | server_v5_core | asyncio | æµ‹è¯•å·¥å…· |

## ğŸ¯ å…³é”®è®¾è®¡æ¨¡å¼

### 1. **åˆ†å±‚ç»§æ‰¿æ¨¡å¼**
- V3 â†’ V4 â†’ V5 é€å±‚ç»§æ‰¿
- æ¯å±‚å¢åŠ æ–°åŠŸèƒ½ï¼Œä¿æŒå‘ä¸‹å…¼å®¹
- ä½¿ç”¨ `from previous_version import *`

### 2. **æ¨¡å—åŒ–è®¾è®¡**
- æ ¸å¿ƒåŠŸèƒ½ç‹¬ç«‹æˆæ¨¡å— (anti_detection, smart_prompts)
- é…ç½®ç®¡ç†ç‹¬ç«‹ (simple_config)
- æ ¸å¿ƒå¼•æ“ç‹¬ç«‹ (server_v5_core)

### 3. **å·¥å…·åˆ†ç¦»**
- ç®¡ç†å·¥å…·ç‹¬ç«‹ (manage_server, system_manager)
- æµ‹è¯•å·¥å…·ç‹¬ç«‹ (quick_test_v5)
- ä¸ä¸ä¸»æœåŠ¡å™¨è€¦åˆ

## ğŸš€ å½“å‰æ¨èä½¿ç”¨

### ç”Ÿäº§ç¯å¢ƒ
- **ä¸»æœåŠ¡å™¨**: `server_v5.py` (æœ€æ–°åŠŸèƒ½)
- **å¤‡é€‰**: `server_v4_simple.py` (ç¨³å®šç‰ˆæœ¬)

### å¼€å‘æµ‹è¯•
- **æµ‹è¯•å·¥å…·**: `quick_test_v5.py`
- **ç®¡ç†å·¥å…·**: `manage_server.py`

### åŠŸèƒ½æ¨¡å—
- **åçˆ¬è™«**: `anti_detection.py`
- **æ™ºèƒ½æç¤º**: `smart_prompts.py`
- **é…ç½®ç®¡ç†**: `simple_config.py`

## ğŸ“ ç»´æŠ¤å»ºè®®

1. **ä¸»è¦ç»´æŠ¤**: ä¸“æ³¨äº V5 ç›¸å…³æ–‡ä»¶
2. **å…¼å®¹æ€§**: ä¿æŒ V3/V4 çš„å‘ä¸‹å…¼å®¹
3. **æ¨¡å—åŒ–**: æ–°åŠŸèƒ½ä¼˜å…ˆè€ƒè™‘ç‹¬ç«‹æ¨¡å—
4. **æµ‹è¯•**: ä½¿ç”¨ quick_test_v5.py éªŒè¯åŠŸèƒ½

## ğŸ”§ éƒ¨ç½²é…ç½®

å½“å‰é¡¹ç›®ä½¿ç”¨ `server.py` ä½œä¸ºä¸»å…¥å£ï¼Œä½†å®é™…ä¸Šåº”è¯¥ä½¿ç”¨ `server_v5.py` è·å¾—æœ€æ–°åŠŸèƒ½ã€‚

å»ºè®®æ›´æ–°éƒ¨ç½²é…ç½®ï¼š
```json
{
    "mcpServers": {
        "ContextScraper": {
            "command": "uv",
            "args": ["run", "--with", "mcp", "mcp", "run", "server_v5.py"],
            "cwd": "/path/to/context-scraper-mcp-server"
        }
    }
}
```
