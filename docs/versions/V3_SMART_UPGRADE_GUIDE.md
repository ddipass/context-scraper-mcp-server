# 🚀 Context Scraper V3 智能版升级指南

## 📋 版本对比

| 版本 | 文件名 | 工具数量 | 提示数量 | 特色功能 |
|------|--------|----------|----------|----------|
| V1 原版 | `server.py` | 8个 | 8个 | 基础功能 |
| V2 技术增强版 | `server_v2_enhanced.py` | 12个 | 13个 | 反爬虫技术 |
| **V3 智能版** | `server_v3_smart.py` | **12个** | **5个口语化** | **智能理解** |

## 🎯 V3 智能版核心优势

### 1. **口语化交互**
**以前**：需要记住具体的提示名称
```
用户：使用 competitive_intelligence 分析竞争对手
```

**现在**：自然语言交流
```
用户：帮我看看竞争对手在搞什么活动
系统：🤖 我理解你想做竞争分析，我会用隐身模式偷偷看看...
```

### 2. **智能意图识别**
系统会自动分析你的话，识别：
- **主要意图**：研究、提取数据、监控、检查
- **特殊场景**：访问困难、反爬虫、动态内容
- **数据类型**：价格、产品、联系方式
- **处理方式**：是否需要隐身、竞争分析等

### 3. **5个万能提示**

#### 🤖 `help_me_crawl` - 万能助手
```
"帮我看看这几个网站在卖什么"
"这个网站访问不了，帮我想办法"  
"偷偷研究一下他们怎么做的"
```

#### 🔍 `help_me_research` - 研究助手
```
"帮我研究一下AI最新发展"
"分析一下竞争对手在做什么"
```

#### 📊 `help_me_get_data` - 数据提取
```
"帮我把这些网站的价格信息抓出来"
"我要这几个页面的联系方式"
```

#### 📈 `help_me_monitor` - 监控助手
```
"帮我盯着这个网站，有新产品就告诉我"
"看看竞争对手有没有降价"
```

#### 🔍 `help_me_check` - 网站体检
```
"这网站怎么样？"
"为什么老是爬不到数据？"
```

## 🛠️ 升级部署

### 1. 文件结构
```
context-scraper-mcp-server/
├── server.py                    # V1 原版
├── server_v2_enhanced.py        # V2 技术版  
├── server_v3_smart.py          # 🆕 V3 智能版
├── anti_detection.py            # 反爬虫模块
├── smart_prompts.py            # 🆕 智能提示模块
└── V3_SMART_UPGRADE_GUIDE.md   # 本指南
```

### 2. MCP 配置
```json
{
    "mcpServers": {
        "ContextScraperSmart": {
            "command": "uv",
            "args": ["run", "--with", "mcp", "mcp", "run", "server_v3_smart.py"],
            "cwd": "/Users/dpliu/EC2/context-scraper-mcp-server"
        }
    }
}
```

### 3. 启动命令
```bash
# 停止现有服务器
python manage_server.py stop

# 启动V3智能版
uv run --with mcp mcp run server_v3_smart.py
```

## 🎨 使用体验对比

### **场景1：竞争对手分析**

**V1/V2 方式**：
```
用户：使用 competitive_intelligence 提示，分析 site1.com,site2.com 的产品策略
```

**V3 智能方式**：
```
用户：帮我看看这几个竞争对手最近在搞什么活动
系统：🤖 我理解你想做竞争分析...
      🚀 执行计划：使用隐身模式 + 并发处理...
      ✅ 自动处理反爬虫限制...
```

### **场景2：数据提取困难**

**V1/V2 方式**：
```
用户：这个网站有反爬虫，需要使用 crawl_stealth 然后用 crawl_with_retry
```

**V3 智能方式**：
```
用户：这个网站老是访问不了，但我需要里面的联系方式
系统：🤖 我发现这是访问困难 + 联系信息提取需求
      🛡️ 自动启用：重试机制 + 隐身模式 + 联系信息选择器
```

## 🧠 智能特性详解

### 1. **意图识别关键词**
- **研究类**：研究、分析、了解、看看、调查
- **提取类**：抓数据、获取、收集、整理、爬取
- **监控类**：监控、盯着、关注、跟踪、定期看
- **检查类**：检查、测试、体检、诊断、评估
- **隐身类**：偷偷、悄悄、隐身、不被发现、绕过

### 2. **问题场景识别**
- **访问困难**：打不开、访问不了、进不去、连不上
- **反爬虫**：被封、被限制、验证码、人机验证
- **动态内容**：动态加载、需要等待、慢慢加载

### 3. **数据类型识别**
- **价格信息**：价格、报价、定价、收费、多少钱
- **产品信息**：产品、商品、货物、东西、服务
- **联系方式**：联系方式、电话、邮箱、地址、微信

## 💡 最佳实践

### 1. **自然表达**
❌ 不要：使用 crawl_stealth 工具爬取竞争对手数据
✅ 推荐：偷偷看看竞争对手最近在做什么

### 2. **描述需求**
❌ 不要：执行 competitive_intelligence 提示
✅ 推荐：我想了解这几个同行的定价策略

### 3. **说明困难**
❌ 不要：网站有反爬虫，使用相应工具
✅ 推荐：这个网站老是访问不了，帮我想想办法

## 🔄 版本选择建议

### **V3 智能版适合**：
- 🎯 日常使用，追求简单易用
- 🗣️ 喜欢自然语言交流
- 🤖 希望系统自动选择最佳策略
- 📱 移动端或语音输入用户

### **V2 技术版适合**：
- 🔧 技术用户，需要精确控制
- ⚙️ 复杂场景，需要特定工具组合
- 🎛️ 批量处理，需要详细配置

### **V1 原版适合**：
- 🛡️ 保守用户，追求稳定性
- 📚 学习用途，了解基础功能
- 🔄 备份方案，应急使用

## 🚀 升级建议

**推荐升级路径**：
1. **测试阶段**：保留现有版本，并行测试V3
2. **适应阶段**：逐步使用V3的口语化功能
3. **完全切换**：确认满意后完全使用V3

**配置建议**：
- 生产环境：V3 智能版
- 开发测试：保留V2技术版
- 应急备份：保留V1原版

V3智能版让爬虫使用变得像和朋友聊天一样简单！🎉
