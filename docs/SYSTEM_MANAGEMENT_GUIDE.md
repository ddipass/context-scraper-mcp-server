# 🛠️ 系统管理功能指南

## 📋 功能概览

V3 智能版新增了强大的系统管理功能，让你可以通过 Amazon Q 轻松管理服务器状态和清理垃圾文件。

### 🆕 新增工具 (5个)
- `check_server_status` - 检查服务器状态
- `manage_server` - 管理服务器 (启动/停止/重启)
- `scan_junk_files` - 扫描垃圾文件
- `clean_junk_files` - 清理垃圾文件
- `get_system_info` - 获取系统信息

### 🆕 新增提示 (1个)
- `help_me_manage_system` - 系统管理助手

## 🎯 使用场景

### 场景1：检查服务器状态
```
用户："看看服务器怎么样"
系统：🤖 我来检查服务器状态...
      📊 显示运行状态、进程信息、版本信息
```

### 场景2：清理垃圾文件
```
用户："磁盘空间不够了，帮我清理一下"
系统：🧹 我来扫描和清理垃圾文件...
      📊 显示垃圾文件统计和清理结果
```

### 场景3：系统监控
```
用户："检查一下系统资源使用情况"
系统：💻 我来获取系统信息...
      📊 显示磁盘、内存、CPU使用情况
```

### 场景4：服务器管理
```
用户："服务器有问题，帮我重启一下"
系统：🛠️ 我来管理服务器...
      ✅ 执行重启命令并确认结果
```

## 🛠️ 工具详细说明

### 1. check_server_status - 服务器状态检查
```python
# 检查服务器运行状态
result = await check_server_status()
```

**功能**：
- 执行 `python manage_server.py status`
- 显示服务器进程信息
- 检查文件状态和版本信息
- 确认服务器是否正常响应

**输出示例**：
```
📊 服务器状态检查

✅ 状态检查成功

📁 文件状态:
  server.py: ✅ 存在
  server_v2_enhanced.py: ✅ 存在
  server_v3_smart.py: ✅ 存在

🔄 运行状态:
  ✅ 运行中 (1 个进程)
    PID 12345
  📦 版本: V3智能版
```

### 2. manage_server - 服务器管理
```python
# 重启服务器
result = await manage_server("restart")
```

**支持命令**：
- `status` - 查看状态
- `start` - 启动服务器
- `stop` - 停止服务器  
- `restart` - 重启服务器

**安全特性**：
- 命令白名单验证
- 执行超时保护
- 详细错误报告

### 3. scan_junk_files - 垃圾文件扫描
```python
# 扫描垃圾文件
result = await scan_junk_files()
```

**扫描类别**：
- **缓存文件**: `__pycache__`, `.pytest_cache`, `.crawl4ai`
- **日志文件**: `*.log`, `crawl4ai.log`
- **临时文件**: `*.tmp`, `.DS_Store`, `Thumbs.db`
- **浏览器缓存**: `browser-profile-*`, `chrome_*`

**扫描范围**：
- 项目目录
- 系统临时目录
- 用户缓存目录

**输出示例**：
```
🗑️ 垃圾文件扫描结果

总计: 40.5 MB (2130 个文件)

📋 分类统计
- 缓存文件: 25.3 MB (1500 个文件)
- 日志文件: 10.2 MB (450 个文件)
- 临时文件: 5.0 MB (180 个文件)

💡 建议: 垃圾文件较多，建议清理
```

### 4. clean_junk_files - 垃圾文件清理
```python
# 清理垃圾文件
result = await clean_junk_files("缓存文件,日志文件", max_age_days=7)
```

**参数说明**：
- `categories`: 清理类别 (逗号分隔)
- `max_age_days`: 文件最大年龄 (天)

**安全机制**：
- 只清理指定类别的文件
- 只清理超过指定天数的文件
- 跳过重要系统文件
- 详细的错误处理

**输出示例**：
```
🧹 垃圾文件清理结果

✅ 清理成功
- 清理大小: 35.2 MB
- 清理文件: 1850 个
- 文件年龄: 超过 7 天
- 清理类别: 缓存文件,日志文件

📋 清理详情
- __pycache__/module.pyc - 2.5 MB
- .crawl4ai/cache/data.tmp - 1.8 MB
- logs/crawl4ai.log - 5.2 MB
```

### 5. get_system_info - 系统信息
```python
# 获取系统信息
result = await get_system_info()
```

**监控指标**：
- **磁盘使用**: 总容量、已使用、可用空间
- **内存使用**: 总内存、已使用、可用内存
- **CPU使用**: 使用率、核心数
- **项目信息**: 项目路径

**健康提示**：
- 磁盘使用率 > 90%: ⚠️ 警告
- 磁盘使用率 > 80%: 💡 提示
- 内存使用率 > 90%: ⚠️ 警告

**输出示例**：
```
💻 系统信息

💾 磁盘使用情况
- 总容量: 500.0 GB
- 已使用: 493.0 GB (98.6%)
- 可用空间: 7.0 GB

🧠 内存使用情况
- 总内存: 16.0 GB
- 已使用: 12.6 GB (78.7%)
- 可用内存: 3.4 GB

⚡ CPU使用情况
- CPU使用率: 21.2%
- CPU核心数: 8

⚠️ 警告: 磁盘使用率过高 (98.6%)，建议清理垃圾文件
```

## 🎨 智能提示使用

### help_me_manage_system - 系统管理助手

**口语化表达**：
```
"看看服务器怎么样"
"检查一下系统状态"  
"清理一下垃圾文件"
"磁盘空间够不够用"
"服务器有没有在运行"
"帮我重启一下服务器"
```

**自动执行计划**：
1. **分析用户需求** - 识别管理意图
2. **选择合适工具** - 自动选择最佳工具组合
3. **执行管理任务** - 按计划执行操作
4. **提供详细报告** - 生成操作结果报告

## 📊 实际测试结果

### 测试环境
- **系统**: macOS
- **磁盘使用**: 98.6% (需要清理)
- **内存使用**: 78.7% (正常)
- **垃圾文件**: 40.5 MB (2130个文件)

### 清理效果
- **清理前**: 40.5 MB 垃圾文件
- **清理后**: 释放 35.2 MB 空间
- **清理率**: 87% 清理成功

## 💡 最佳实践

### 1. 定期维护
```
建议每周执行一次：
1. 检查服务器状态
2. 扫描垃圾文件
3. 清理超过7天的垃圾文件
4. 监控系统资源使用
```

### 2. 安全清理
```
推荐清理策略：
- 缓存文件: 超过3天
- 日志文件: 超过7天  
- 临时文件: 超过1天
- 浏览器缓存: 超过7天
```

### 3. 监控告警
```
关注指标：
- 磁盘使用率 > 90%: 立即清理
- 内存使用率 > 90%: 检查进程
- 服务器无响应: 重启服务器
```

## 🔄 集成使用

### 与爬虫功能结合
```
用户："爬取数据前先检查一下系统状态"
系统：
1. 检查服务器状态
2. 检查磁盘空间
3. 必要时清理垃圾文件
4. 确认系统健康后开始爬取
```

### 自动化维护
```
用户："帮我做个全面的系统检查和清理"
系统：
1. 检查服务器运行状态
2. 获取系统资源信息
3. 扫描垃圾文件情况
4. 执行安全清理操作
5. 生成维护报告
```

## 🎉 功能优势

1. **一站式管理**: 服务器状态、垃圾清理、系统监控
2. **智能识别**: 自动理解用户管理需求
3. **安全可靠**: 多重安全机制保护系统
4. **详细报告**: 提供完整的操作日志
5. **口语化交互**: 像和朋友聊天一样管理系统

这些系统管理功能让 Context Scraper 不仅是一个爬虫工具，更是一个完整的系统管理助手！🚀
